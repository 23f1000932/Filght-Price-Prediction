<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Price Prediction | Kaggle MLP 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif']
                    }
                }
            }
        };
    </script>
    <style>
        body,
        .glass-card,
        nav,
        .text-slate-300,
        .text-white {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .parallax-bg {
            background: radial-gradient(circle at 20% 20%, rgba(45, 212, 191, 0.14), transparent 60%),
                radial-gradient(circle at 80% 20%, rgba(248, 113, 113, 0.12), transparent 55%);
        }

        .dark .parallax-bg {
            background: radial-gradient(circle at 20% 20%, rgba(45, 212, 191, 0.2), transparent 60%),
                radial-gradient(circle at 80% 20%, rgba(248, 113, 113, 0.2), transparent 55%);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            border: 1px solid rgba(148, 163, 184, 0.18);
            box-shadow: 0 18px 40px -24px rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        .dark .glass-card {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(148, 163, 184, 0.24);
            box-shadow: 0 20px 45px -20px rgba(15, 23, 42, 0.9);
        }

        .glass-card:hover {
            transform: translateY(-6px);
        }

        .floating-badge {
            background: linear-gradient(135deg, rgba(45, 212, 191, 0.18), rgba(244, 63, 94, 0.14));
            border: 1px solid rgba(45, 212, 191, 0.4);
        }

        .dark .floating-badge {
            background: linear-gradient(135deg, rgba(45, 212, 191, 0.24), rgba(248, 113, 113, 0.2));
            border-color: rgba(148, 163, 184, 0.32);
        }

        .split-toggle button {
            border-radius: 9999px;
            border: 1px solid rgba(15, 23, 42, 0.12);
            background: rgba(148, 163, 184, 0.12);
            color: #475569;
            transition: all 0.25s ease;
        }

        .dark .split-toggle button {
            border-color: rgba(148, 163, 184, 0.26);
            background: rgba(71, 85, 105, 0.25);
            color: #e2e8f0;
        }

        .split-toggle button.is-active {
            background: linear-gradient(120deg, #2dd4bf, #f43f5e);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 16px 35px -22px rgba(244, 63, 94, 0.65);
        }

        .dark .split-toggle button.is-active {
            box-shadow: 0 18px 32px -20px rgba(45, 212, 191, 0.55);
        }

        .animate-on-scroll {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .animate-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .slide-in-left {
            transform: translateX(-30px);
        }

        .slide-in-right {
            transform: translateX(30px);
        }

        .fade-up {
            transform: translateY(24px);
        }

        .hero-gradient {
            background: radial-gradient(circle at top, rgba(244, 63, 94, 0.08), transparent 55%),
                radial-gradient(circle at 20% 80%, rgba(56, 189, 248, 0.1), transparent 65%);
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-[#0f172a] text-slate-900 dark:text-slate-100 min-h-screen antialiased">
    <header class="relative overflow-hidden">
        <div data-parallax="-0.15" class="absolute inset-0 parallax-bg opacity-80"></div>
        <nav
            class="relative z-10 border-b border-slate-200/60 dark:border-white/10 bg-white/80 dark:bg-[#0f172a]/80 backdrop-blur shadow-sm">
            <div class="max-w-7xl mx-auto px-4 py-5 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div
                        class="h-10 w-10 rounded-full bg-gradient-to-br from-teal-400 to-rose-500 flex items-center justify-center text-white font-semibold">
                        FP</div>
                    <div>
                        <p class="text-sm uppercase tracking-[0.3em] text-slate-500 dark:text-slate-400">Kaggle MLP</p>
                        <h1 class="text-lg font-semibold text-slate-900 dark:text-slate-100">Flight Price Prediction</h1>
                    </div>
                </div>
                <button id="themeToggle"
                    class="theme-toggle flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium text-slate-600 dark:text-slate-100">
                    <i class="fa-solid fa-circle-half-stroke"></i>
                    <span>Toggle Theme</span>
                </button>
                </div>
        </nav>

        <section class="relative z-10 hero-gradient">
            <div class="max-w-7xl mx-auto px-4 py-24 grid lg:grid-cols-2 gap-12 items-center">
                <div class="space-y-6 animate-on-scroll slide-in-left">
                    <span
                        class="inline-flex items-center gap-2 floating-badge px-4 py-2 rounded-full text-sm text-teal-600 dark:text-teal-200">
                        <i class="fa-solid fa-plane-departure"></i>
                        <span>Kaggle Playground Series · Jan 2025</span>
                    </span>
                    <h2 class="text-4xl md:text-5xl font-semibold leading-tight">Capturing airline pricing signals before
                        take-off.</h2>
                    <p class="text-lg text-slate-600 dark:text-slate-300 max-w-xl">
                        Built for the Kaggle MLP Term 2 competition, this dashboard distills experiments across 300K+
                        itineraries,
                        surfacing the drivers that push fares up or down across class, carrier, route, and booking timelines.
                    </p>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="glass-card rounded-2xl p-4">
                            <p class="text-3xl font-semibold text-slate-900 dark:text-white" data-metric="topModelScore"
                                data-format="percentage"></p>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Leaderboard score from LightGBM baseline</p>
                        </div>
                        <div class="glass-card rounded-2xl p-4">
                            <p class="text-3xl font-semibold text-slate-900 dark:text-white" data-metric="classDifferential"
                                data-format="multiplier"></p>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Business vs economy fare multiple</p>
                        </div>
                        <div class="glass-card rounded-2xl p-4">
                            <p class="text-3xl font-semibold text-slate-900 dark:text-white" data-metric="passengerRecords"
                                data-format="compact"></p>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Passenger samples fueling the model</p>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <a href="#insights"
                            class="inline-flex items-center gap-2 px-5 py-3 rounded-full bg-slate-900 text-white dark:bg-white dark:text-slate-900 font-medium">
                            Explore Findings <i class="fa-solid fa-arrow-right"></i>
                        </a>
                        <a href="https://www.kaggle.com/competitions/mlp-python-jan-2025" target="_blank" rel="noopener"
                            class="inline-flex items-center gap-2 px-5 py-3 rounded-full bg-white/80 dark:bg-white/10 text-slate-700 dark:text-slate-100 font-medium">
                            Kaggle Competition <i class="fa-brands fa-kaggle"></i>
                        </a>
                    </div>
                </div>
                <div class="relative animate-on-scroll slide-in-right">
                    <div data-parallax="0.08"
                        class="absolute -inset-6 rounded-3xl bg-gradient-to-br from-teal-400/20 via-white/5 to-rose-500/20 blur-3xl">
                    </div>
                    <div class="relative glass-card rounded-3xl p-8 space-y-6">
                        <h3 class="text-xl font-semibold">Quick Summary</h3>
                        <dl class="space-y-4 text-sm">
                            <div class="flex items-center justify-between">
                                <dt class="text-slate-500 dark:text-slate-400">Best Performing Model</dt>
                                <dd class="font-semibold" data-metric="topModel"></dd>
                            </div>
                            <div class="flex items-center justify-between">
                                <dt class="text-slate-500 dark:text-slate-400">Pipelines Evaluated</dt>
                                <dd class="font-semibold" data-metric="pipelines" data-format="integer"></dd>
                            </div>
                            <div class="flex items-center justify-between">
                                <dt class="text-slate-500 dark:text-slate-400">Optimized Metric</dt>
                                <dd class="font-semibold" data-metric="optimizedMetric"></dd>
                            </div>
                            <div class="flex items-center justify-between">
                                <dt class="text-slate-500 dark:text-slate-400">Economy Fare (avg)</dt>
                                <dd class="font-semibold" data-metric="economyAvgFare" data-format="currency"></dd>
                            </div>
                            <div class="flex items-center justify-between">
                                <dt class="text-slate-500 dark:text-slate-400">Business Fare (avg)</dt>
                                <dd class="font-semibold" data-metric="businessAvgFare" data-format="currency"></dd>
                            </div>
                        </dl>
                        <div class="text-xs text-slate-500 dark:text-slate-400">Data source: Synthetic airline itineraries · Train/validation
                            split engineered locally.</div>
                        </div>
                </div>
                </div>
                </section>
    </header>

    <main id="insights" class="relative">
        <section class="py-20">
            <div class="max-w-7xl mx-auto px-4">
                <div class="grid lg:grid-cols-2 gap-10">
                    <article class="glass-card rounded-3xl p-8 space-y-6 animate-on-scroll fade-up">
                        <h3 class="text-2xl font-semibold">Journey to the Leaderboard</h3>
                        <ol class="space-y-5 text-sm text-slate-600 dark:text-slate-300">
                            <li class="flex gap-4">
                                <span
                                    class="w-8 h-8 rounded-full bg-teal-500/20 text-teal-600 dark:text-teal-200 flex items-center justify-center font-semibold">1</span>
                                <div>
                                    <h4 class="font-semibold text-slate-900 dark:text-white">Feature vault, fully engineered</h4>
                                    <p>Encoded class, airline, booking window, and route metadata into signal-rich categorical + numerical blends.</p>
                                    </div>
                            </li>
                            <li class="flex gap-4">
                                <span
                                    class="w-8 h-8 rounded-full bg-rose-500/20 text-rose-500 dark:text-rose-300 flex items-center justify-center font-semibold">2</span>
                                <div>
                                    <h4 class="font-semibold text-slate-900 dark:text-white">Gradient boosted sweet spot</h4>
                                    <p>LightGBM outperformed XGBoost and Random Forest by balancing shallow depth with learning-rate decay.</p>
                                    </div>
                            </li>
                            <li class="flex gap-4">
                                <span
                                    class="w-8 h-8 rounded-full bg-sky-500/20 text-sky-500 dark:text-sky-300 flex items-center justify-center font-semibold">3</span>
                                <div>
                                    <h4 class="font-semibold text-slate-900 dark:text-white">Residual rescue</h4>
                                    <p>Calendar-aware cross-validation and feature interactions on booking lead time squashed tail errors.</p>
                                    </div>
                            </li>
                            </ol>
                            </article>
                            
                            <aside class="glass-card rounded-3xl p-8 space-y-6 animate-on-scroll fade-up">
                                <h3 class="text-2xl font-semibold">Model Leaderboard</h3>
                                <div class="grid gap-4" data-leaderboard></div>
                                <p class="text-xs text-slate-500 dark:text-slate-400">Scores shown as cross-validated R² equivalents · Higher is
                                    better.</p>
                            </aside>
                            </div>
                            </div>
                            </section>

        <section class="py-20 bg-white dark:bg-[#0b1220] border-y border-slate-200/60 dark:border-white/10">
            <div class="max-w-7xl mx-auto px-4 space-y-12">
                <div class="flex flex-wrap items-center justify-between gap-4">
                    <div>
                        <h3 class="text-3xl font-semibold">Dataset Pulse</h3>
                        <p class="text-slate-600 dark:text-slate-300 max-w-2xl">Switch between training and validation splits to see how class
                            balance, booking horizon pricing, and airline averages shift.</p>
                    </div>
                    <div class="split-toggle flex items-center gap-3">
                        <button class="px-5 py-2 text-sm font-medium shadow-sm" data-split-toggle="train">Training Split</button>
                        <button class="px-5 py-2 text-sm font-medium shadow-sm" data-split-toggle="validation">Validation Split</button>
                    </div>
                    </div>

                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="glass-card rounded-3xl p-6 space-y-4 animate-on-scroll fade-up">
                        <header class="flex items-center justify-between">
                            <h4 class="text-lg font-semibold">Cabin Class Mix</h4>
                            <span class="text-sm text-slate-500 dark:text-slate-400">Economy vs Business</span>
                        </header>
                        <div class="h-64">
                            <canvas id="classChart"></canvas>
                        </div>
                    </div>
                    <div class="glass-card rounded-3xl p-6 space-y-4 animate-on-scroll fade-up">
                        <header class="flex items-center justify-between">
                            <h4 class="text-lg font-semibold">Booking Window vs Fare</h4>
                            <span class="text-sm text-slate-500 dark:text-slate-400">Days left until departure</span>
                        </header>
                        <div class="h-64">
                            <canvas id="daysLeftChart"></canvas>
                        </div>
                    </div>
                    <div class="glass-card rounded-3xl p-6 space-y-4 animate-on-scroll fade-up">
                        <header class="flex items-center justify-between">
                            <h4 class="text-lg font-semibold">Average Fare by Airline</h4>
                            <span class="text-sm text-slate-500 dark:text-slate-400">₹ per passenger</span>
                        </header>
                        <div class="h-64">
                            <canvas id="airlineChart"></canvas>
                        </div>
                    </div>
                    <div class="glass-card rounded-3xl p-6 space-y-4 animate-on-scroll fade-up">
                        <header class="flex items-center justify-between">
                            <h4 class="text-lg font-semibold">Feature Influence</h4>
                            <span class="text-sm text-slate-500 dark:text-slate-400">Relative importance</span>
                        </header>
                        <div class="h-64">
                            <canvas id="featureImpChart"></canvas>
                        </div>
                    </div>
                    </div>
                    </div>
                    </section>

        <section class="py-20">
            <div class="max-w-6xl mx-auto px-4 grid lg:grid-cols-2 gap-10">
                <article class="glass-card rounded-3xl p-8 space-y-5 animate-on-scroll fade-up">
                    <h3 class="text-2xl font-semibold">North Star Metrics</h3>
                    <div class="grid sm:grid-cols-2 gap-6">
                        <div>
                            <p class="text-3xl font-semibold text-slate-900 dark:text-white" data-metric="lateBookingMultiplier"
                                data-format="multiplier"></p>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Fare surge within 3 days of departure</p>
                        </div>
                        <div>
                            <p class="text-3xl font-semibold text-slate-900 dark:text-white" data-metric="featureCount" data-format="integer">
                            </p>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Active engineered features</p>
                        </div>
                        <div>
                            <p class="text-3xl font-semibold text-slate-900 dark:text-white" data-metric="economyAvgFare"
                                data-format="currency"></p>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Average economy fare</p>
                        </div>
                        <div>
                            <p class="text-3xl font-semibold text-slate-900 dark:text-white" data-metric="businessAvgFare"
                                data-format="currency"></p>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Average business fare</p>
                        </div>
                    </div>
                </article>
                <aside class="glass-card rounded-3xl p-8 space-y-6 animate-on-scroll fade-up">
                    <h3 class="text-2xl font-semibold">Call to Action</h3>
                    <p class="text-slate-600 dark:text-slate-300">Next steps include wiring this dashboard to refreshed inference
                        outputs and exposing scenario toggles (e.g., route, carrier, loyalty tier) to help revenue teams plan
                        promotional windows.</p>
                    <div class="flex flex-wrap gap-4">
                        <a href="https://github.com/" target="_blank" rel="noopener"
                            class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-slate-900 text-white dark:bg-white dark:text-slate-900">
                            View Repository <i class="fa-brands fa-github"></i>
                        </a>
                        <a href="mailto:yourname@example.com"
                            class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/80 dark:bg-white/10 text-slate-700 dark:text-slate-100">
                            Collaborate <i class="fa-solid fa-envelope"></i>
                        </a>
                    </div>
                </aside>
                </div>
                </section>
    </main>

    <footer class="border-t border-slate-200/60 dark:border-white/10 bg-white/80 dark:bg-[#0f172a]/80 backdrop-blur py-10">
        <div class="max-w-7xl mx-auto px-4 flex flex-wrap justify-between gap-4 text-sm text-slate-500 dark:text-slate-400">
            <p>&copy; 2025 Flight Price Prediction Dashboard · Kaggle MLP Term 2</p>
            <div class="flex items-center gap-5">
                <a href="https://www.kaggle.com/competitions/mlp-python-jan-2025"
                    class="hover:text-slate-900 dark:hover:text-white" target="_blank" rel="noopener"><i
                        class="fa-brands fa-kaggle"></i></a>
                <a href="https://github.com/" class="hover:text-slate-900 dark:hover:text-white" target="_blank"
                    rel="noopener"><i class="fa-brands fa-github"></i></a>
                <a href="https://www.linkedin.com" class="hover:text-slate-900 dark:hover:text-white" target="_blank"
                    rel="noopener"><i class="fa-brands fa-linkedin"></i></a>
            </div>
        </div>
    </footer>

    <script>
            const FALLBACK_DASHBOARD_DATA = {
                summary: {
                    topModel: 'LightGBM',
                    topModelScore: 0.9845,
                    featureCount: 11,
                    passengerRecords: 300592,
                    classDifferential: 3.6,
                    businessAvgFare: 52512,
                    economyAvgFare: 6572,
                    lateBookingMultiplier: 3.4,
                    pipelines: 4,
                    optimizedMetric: 'RMSE',
                    modelLeaderboard: [
                        { name: 'LightGBM', score: 0.9845 },
                        { name: 'Random Forest', score: 0.976 },
                        { name: 'Decision Tree', score: 0.921 }
                    ]
                },
                classDistribution: {
                    train: { labels: ['Economy', 'Business'], counts: [206666, 93487] },
                    validation: { labels: ['Economy', 'Business'], counts: [51667, 23371] }
                },
                airlineAverage: {
                    train: { labels: ['Vistara', 'Air India', 'SpiceJet', 'Indigo', 'GO_FIRST', 'AirAsia'], values: [30396, 23507, 6179, 5324, 5657, 4091] },
                    validation: { labels: ['Vistara', 'Air India', 'SpiceJet', 'Indigo', 'GO_FIRST', 'AirAsia'], values: [30514, 23342, 6239, 5408, 5784, 4216] }
                },
                daysLeft: {
                    train: { labels: [50, 45, 40, 35, 30, 25, 20, 15, 10, 7, 5, 3, 1], prices: [6100, 6050, 6120, 6400, 6800, 7200, 7800, 9200, 13400, 15600, 18800, 21400, 23800] },
                    validation: { labels: [50, 45, 40, 35, 30, 25, 20, 15, 10, 7, 5, 3, 1], prices: [5900, 6000, 6080, 6370, 6750, 7120, 7740, 9100, 13100, 15250, 18300, 20750, 23200] }
                },
                featureImportance: {
                    labels: ['Class (Eco/Biz)', 'Duration', 'Days_Left', 'Airline', 'Source', 'Stops', 'Departure_Time'],
                    values: [0.35, 0.2, 0.18, 0.1, 0.08, 0.05, 0.04]
                }
            };

            const state = {
                charts: {},
                activeSplit: 'train',
                data: null
            };

        const htmlElement = document.documentElement;
            const themeToggleBtn = document.getElementById('themeToggle');

            initTheme();
            setupThemeToggle();
            initDashboard();

            async function initDashboard() {
                state.data = await loadDashboardData();
                populateSummary(state.data.summary);
                buildModelLeaderboard(state.data.summary.modelLeaderboard);
                buildCharts(state.data, state.activeSplit);
                setupSplitToggle();
                setupScrollAnimations();
                setupParallax();
                updateChartsTheme();
        }

            function initTheme() {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme) {
                    htmlElement.classList.toggle('dark', savedTheme === 'dark');
                    return;
                }
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                htmlElement.classList.toggle('dark', prefersDark);
            }

            function setupThemeToggle() {
                if (!themeToggleBtn) return;
            themeToggleBtn.addEventListener('click', () => {
                const isDark = htmlElement.classList.toggle('dark');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                updateChartsTheme();
            });
        }

            async function loadDashboardData() {
                try {
                    const response = await fetch('Dataset/dashboard-metrics.json', { cache: 'no-store' });
                    if (!response.ok) throw new Error('Failed to load metrics JSON');
                    return await response.json();
                } catch (error) {
                    console.warn('Using fallback metrics data.', error);
                    return structuredClone(FALLBACK_DASHBOARD_DATA);
                }
            }

            function populateSummary(summary) {
                if (!summary) return;
                document.querySelectorAll('[data-metric]').forEach(node => {
                    const key = node.dataset.metric;
                    const rawValue = summary[key];
                    if (rawValue === undefined) return;
                    const format = node.dataset.format || 'text';
                    const formatted = formatMetric(rawValue, format);
                    if (node.dataset.template) {
                        node.textContent = node.dataset.template.replace('{{value}}', formatted);
                    } else {
                        node.textContent = formatted;
                    }
                });
        }

            function formatMetric(value, format) {
                switch (format) {
                    case 'percentage':
                        return `${(value * 100).toFixed(2).replace(/\.00$/, '')}%`;
                    case 'compact':
                        return new Intl.NumberFormat('en', { notation: 'compact', maximumFractionDigits: 1 }).format(value);
                    case 'currency':
                        return new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 }).format(value);
                    case 'multiplier':
                        return `${Number(value).toFixed(1).replace(/\.0$/, '')}x`;
                    case 'integer':
                        return Math.round(value).toLocaleString('en-IN');
                    default:
                        return value;
                }
            }

            function buildModelLeaderboard(models = []) {
                document.querySelectorAll('[data-leaderboard]').forEach(container => {
                    container.innerHTML = '';
                    models.forEach(model => {
                        const card = document.createElement('div');
                        card.className = 'rounded-2xl border border-slate-200/60 dark:border-white/10 p-4 bg-white/80 dark:bg-white/5 shadow-sm';

                    const header = document.createElement('div');
                    header.className = 'flex items-center justify-between';

                    const name = document.createElement('span');
                    name.className = 'font-medium text-slate-700 dark:text-slate-200';
                    name.textContent = model.name;

                    const score = document.createElement('span');
                    score.className = 'font-semibold text-teal-600 dark:text-teal-300';
                    score.textContent = formatMetric(model.score, 'percentage');

                    header.append(name, score);

                    const progressOuter = document.createElement('div');
                    progressOuter.className = 'h-2 rounded-full bg-slate-200 dark:bg-white/10 overflow-hidden mt-3';

                    const progressInner = document.createElement('div');
                    progressInner.className = 'h-full rounded-full bg-gradient-to-r from-teal-400 to-rose-500';
                    progressInner.style.width = `${Math.min(model.score * 100, 100)}%`;

                    progressOuter.appendChild(progressInner);

                    card.append(header, progressOuter);
                    container.appendChild(card);
                });
            });
        }

            function buildCharts(data, split) {
                Chart.defaults.font.family = "'Outfit', sans-serif";
            const colors = getChartColors();

            state.charts.classChart = new Chart(document.getElementById('classChart'), {
                type: 'doughnut',
                data: {
                    labels: data.classDistribution[split].labels,
                    datasets: [{
                        data: data.classDistribution[split].counts,
                        backgroundColor: ['#2dd4bf', '#f43f5e'],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '72%',
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: { usePointStyle: true, boxWidth: 10, color: colors.text }
                        }
                    }
                }
            });

            state.charts.daysLeftChart = new Chart(document.getElementById('daysLeftChart'), {
                type: 'line',
                data: {
                    labels: data.daysLeft[split].labels,
                    datasets: [{
                        label: 'Average Fare (₹)',
                        data: data.daysLeft[split].prices,
                        borderColor: '#f43f5e',
                        backgroundColor: context => {
                            const ctx = context.chart.ctx;
                            const gradient = ctx.createLinearGradient(0, 0, 0, 280);
                            gradient.addColorStop(0, 'rgba(244, 63, 94, 0.45)');
                            gradient.addColorStop(1, 'rgba(244, 63, 94, 0)');
                            return gradient;
                        },
                        fill: true,
                        tension: 0.35,
                        pointRadius: 0,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: {
                            reverse: true,
                            title: { display: true, text: 'Days before departure', color: colors.text },
                            ticks: { color: colors.text },
                            grid: { display: false }
                        },
                        y: {
                            ticks: { color: colors.text },
                            grid: { color: colors.grid, borderDash: [4, 4] }
                        }
                    }
                }
            });

            state.charts.airlineChart = new Chart(document.getElementById('airlineChart'), {
                type: 'bar',
                data: {
                    labels: data.airlineAverage[split].labels,
                    datasets: [{
                        label: 'Average Fare (₹)',
                        data: data.airlineAverage[split].values,
                        backgroundColor: ['#fb7185', '#2dd4bf', '#fcd34d', '#38bdf8', '#34d399', '#f43f5e'],
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: {
                            ticks: { color: colors.text },
                            grid: { display: false }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: { color: colors.text },
                            grid: { color: colors.grid, borderDash: [4, 4] }
                        }
                    }
                }
            });

            state.charts.featureImpChart = new Chart(document.getElementById('featureImpChart'), {
                type: 'bar',
                data: {
                    labels: data.featureImportance.labels,
                    datasets: [{
                        label: 'Impact Score',
                        data: data.featureImportance.values,
                        backgroundColor: 'rgba(20, 184, 166, 0.85)',
                        hoverBackgroundColor: '#5eead4',
                        borderRadius: 10,
                        barThickness: 26
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: {
                            ticks: { color: colors.text },
                            grid: { color: colors.grid, borderDash: [4, 4] }
                        },
                        y: {
                            ticks: { color: colors.text },
                            grid: { display: false }
                        }
                    }
                }
            });
                                }

                                function setupSplitToggle() {
                                    const buttons = document.querySelectorAll('[data-split-toggle]');
                                    buttons.forEach(button => {
                                        button.classList.toggle('is-active', button.dataset.splitToggle === state.activeSplit);
                                        button.addEventListener('click', () => {
                                            const selected = button.dataset.splitToggle;
                                            if (selected === state.activeSplit) return;
                                            state.activeSplit = selected;
                                            buttons.forEach(btn => btn.classList.toggle('is-active', btn === button));
                                            applySplit(selected);
                                        });
                                    });
                                }

                                function applySplit(split) {
                                    if (!state.data) return;
                                    const splitData = state.data.classDistribution[split];
                                    state.charts.classChart.data.labels = splitData.labels;
                                    state.charts.classChart.data.datasets[0].data = splitData.counts;
                                    state.charts.classChart.update();

                                    const airlineData = state.data.airlineAverage[split];
                                    state.charts.airlineChart.data.labels = airlineData.labels;
                                    state.charts.airlineChart.data.datasets[0].data = airlineData.values;
                                    state.charts.airlineChart.update();

                                    const daysData = state.data.daysLeft[split];
                                    state.charts.daysLeftChart.data.labels = daysData.labels;
                                    state.charts.daysLeftChart.data.datasets[0].data = daysData.prices;
                                    state.charts.daysLeftChart.update();
                                }

                                function getChartColors() {
                                    const dark = htmlElement.classList.contains('dark');
                                    return {
                                        text: dark ? '#cbd5f5' : '#475569',
                                        grid: dark ? 'rgba(255, 255, 255, 0.12)' : 'rgba(15, 23, 42, 0.08)'
                                    };
                                }

                                function updateChartsTheme() {
                                    const colors = getChartColors();
                                    Object.values(state.charts).forEach(chart => {
                                        if (!chart) return;
                                        const { scales, plugins } = chart.options;
                                        if (scales) {
                                            ['x', 'y'].forEach(axis => {
                                                const axisCfg = scales[axis];
                                                if (!axisCfg) return;
                                                if (axisCfg.ticks) axisCfg.ticks.color = colors.text;
                                                if (axisCfg.title) axisCfg.title.color = colors.text;
                                                if (axisCfg.grid && axisCfg.grid.display !== false) axisCfg.grid.color = colors.grid;
                                            });
                                        }
                                        if (plugins?.legend?.labels) {
                                            plugins.legend.labels.color = colors.text;
                                        }
                chart.update();
            });
        }

    function setupScrollAnimations() {
        const elements = document.querySelectorAll('.animate-on-scroll');
        if (!('IntersectionObserver' in window)) {
            elements.forEach(el => el.classList.add('is-visible'));
            return;
            }

            const observer = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) return;
                    entry.target.classList.add('is-visible');
                    obs.unobserve(entry.target);
                });
            }, { threshold: 0.15 });

            elements.forEach(el => observer.observe(el));
        }

            function setupParallax() {
                const parallaxNodes = document.querySelectorAll('[data-parallax]');
                if (!parallaxNodes.length) return;
                if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
                const update = () => {
                    const offset = window.scrollY;
                    parallaxNodes.forEach(node => {
                        const speed = parseFloat(node.dataset.parallax || '0');
                        node.style.transform = `translate3d(0, ${offset * speed}px, 0)`;
                    });
                };
                update();
                window.addEventListener('scroll', update, { passive: true });
            }
    </script>
</body>
</html>
